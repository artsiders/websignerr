function showPost(e){let t=document.querySelector(".content_post"),n=document.querySelector(".content_post .close");fetchPost(e),n.addEventListener("click",e=>{t.classList.add("hide")}),t.addEventListener("click",e=>{"post"==e.target.dataset.post&&t.classList.add("hide")})}function fetchPost(e){document.querySelector(".content_post").classList.remove("hide"),e=parseInt(e),fetch(`${location.origin}/websignerr/controlers/posts.php?action=read&id_post=${e}`).then(e=>e.json()).then(e=>{let t=e.principal_item,n=e.post_description,o=e.add_date,s=e.item1,i=e.item2,r=e.item3,d=e.id_post;(e=!0)?(document.querySelector(".content_post .principal_item").innerHTML=`\n                    <img src="${location.origin}/websignerr/assets/images/uploads/${t}" data-idpost="${d}" alt="principal_item">\n                `,document.querySelector(".content_post .description").innerHTML=`<p>poster le : ${o}</p> ${n}`,document.querySelector(".content_post .items").innerHTML=`\n                <div class="item">\n                    <img src="${location.origin}/websignerr/assets/images/uploads/${s}" alt="item1">\n                </div>\n                <div class="item">\n                    <img src="${location.origin}/websignerr/assets/images/uploads/${i}" alt="item2">\n                </div>\n                <div class="item">\n                    <img src="${location.origin}/websignerr/assets/images/uploads/${r}" alt="item3">\n                </div>\n                `):alert("il ya un petit soucis :(")}),fetchComent(e)}function fetchComent(e){let t=document.getElementById("contentComments");document.getElementById("formComment").setAttribute("data-idpost",e),fetch(`${location.origin}/websignerr/controlers/comments.php?action=read&id_post=${e}`).then(e=>e.json()).then(e=>{if(t.innerHTML="","empty"==e)t.innerHTML="<span>Aucun commentaires disponibles</span>";else{let n=localStorage.getItem("id_user");e.forEach(e=>{n==e.id_user?t.innerHTML+=`\n                        <div class="my_comments">\n                            <img onclick="link('./profils&id_user=${e.id_user}')" src="${location.origin}/websignerr/Assets/images/profil/${e.picture}" alt="photo de">\n                            <div class="comment">\n                                ${e.comment}\n                            </div>\n                            <i class="fas fa-trash-alt btn_delete_comment" data-idcomment="${e.id_comment}"></i>\n                        </div>\n                        `:t.innerHTML+=`\n                        <div class="auther_comments">\n                            <div class="comment">\n                                ${e.comment}\n                            </div>\n                            <img onclick="link('./profils&id_user=${e.id_user}')" src="${location.origin}/websignerr/Assets/images/profil/${e.picture}" alt="">\n                        </div>\n                        `})}}),setTimeout(()=>{deleteComment()},1e3)}function createComment(){let e=document.getElementById("formComment"),t=document.getElementById("contentComments");e.addEventListener("submit",n=>{n.preventDefault();let o=new FormData(e);idPost=e.getAttribute("data-idpost"),fetch(`${location.origin}/websignerr/controlers/comments.php?action=create&id_post=${idPost}`,{method:"POST",headers:{"X-Requested-With":"xmlhttprequest"},body:o}).then(e=>e.json()).then(e=>{idUserConnect=localStorage.getItem("id_user"),e.insertIsOk&&(t.innerHTML+=`\n                <div class="my_comments new_comment">\n                    <img src="${location.origin}/websignerr/Assets/images/profil/${localStorage.getItem("picture")}" alt="photo de">\n                    <div class="comment">\n                        ${e.comment}\n                    </div>\n                    <i class="fas fa-trash-alt btn_delete_comment new"></i>\n                </div>`,document.querySelector("#formComment .comment").value="",document.querySelector(".btn_delete_comment.new").addEventListener("click",t=>{fetch(`${location.origin}/websignerr/controlers/comments.php?action=delete&id_comment=${e.id_comment}`).then(e=>e.json()).then(e=>{document.querySelector(".btn_delete_comment.new").parentElement.style.display="none"})}))})})}function deletePost(){document.querySelectorAll(".action .delete").forEach(e=>{e.addEventListener("click",t=>{let n=t.target.dataset.idpost;fetch(`${location.origin}/websignerr/controlers/posts.php?action=delete&id_post=${n}`).then(e=>e.json()).then(t=>{e.parentElement.parentElement.style.display="none"})})})}function deleteComment(){document.querySelectorAll(".btn_delete_comment").forEach(e=>{e.addEventListener("click",t=>{let n=t.target.dataset.idcomment;fetch(`${location.origin}/websignerr/controlers/comments.php?action=delete&id_comment=${n}`).then(e=>e.json()).then(t=>{e.parentElement.style.display="none"})})})}function createPost(){let e=document.getElementById("addPost"),t=document.querySelector(".content_addpost"),n=document.querySelector(".content_addpost textarea"),o=document.querySelector("#addPost > label"),s=document.querySelector("#addPost .close");t.classList.remove("hide"),e.addEventListener("submit",n=>{n.preventDefault();let o=new FormData(e);fetch(`${location.origin}/websignerr/controlers/posts.php?action=create`,{method:"POST",headers:{"X-Requested-With":"xmlhttprequest"},body:o}).then(e=>e.json()).then(e=>{e.insertIsOk?t.classList.add("hide"):(e.principal_item?document.querySelector("#addPost > label").style.border="2px dashed green":document.querySelector("#addPost > label").style.border="2px dashed red",e.inputDescription?document.querySelector("#addPost textarea").style.border="2px solid green":document.querySelector("#addPost textarea").style.border="2px solid red")})}),n.style.border="2px dashed grey",o.style.border="2px dashed grey",s.addEventListener("click",e=>{t.classList.add("hide")}),t.addEventListener("click",e=>{"post"==e.target.dataset.post&&t.classList.add("hide")})}function updatePost(e){let t=document.querySelector(".content_editpost"),n=document.querySelector(".content_editpost textarea"),o=document.querySelector("#editPost .close"),s=document.getElementById("editPost");t.classList.remove("hide"),s.style.display="flex",s.style.flexDirection="column",fetch(`${location.origin}/websignerr/controlers/posts.php?action=read&id_post=${e}`).then(e=>e.json()).then(e=>{let t=e.post_description;n.innerHTML=t}),localStorage.setItem("idpostUpdate",e),n.style.border="2px dashed grey",o.addEventListener("click",e=>{t.classList.add("hide")}),t.addEventListener("click",e=>{"post"==e.target.dataset.post&&t.classList.add("hide")})}function fetchUpdatePost(){editPost.addEventListener("submit",e=>{e.preventDefault();let t=document.querySelector(".content_editpost"),n=localStorage.getItem("idpostUpdate"),o=document.getElementById("editPost"),s=document.querySelector(".content_editpost textarea"),i=new FormData(o);fetch(`${location.origin}/websignerr/controlers/posts.php?action=update&id_post=${n}`,{method:"POST",headers:{"X-Requested-With":"xmlhttprequest"},body:i}).then(e=>e.json()).then(e=>{e.insertIsOk?(alert("tout est OK ðŸ˜‰"),t.classList.add("hide")):e.inputDescription?s.style.border="2px solid green":s.style.border="2px solid red"})})}function updateUserInfo(){let e=document.getElementById("btnUpdateProfil"),t=document.getElementById("formProfilView"),n=document.getElementById("formProfilUpdate");e.addEventListener("click",e=>{t.style.display="none",n.style.display="flex"}),n.addEventListener("submit",e=>{e.preventDefault();let o=new FormData(n);fetch(`${location.origin}/websignerr/controlers/user.php?action=user_info`,{method:"POST",headers:{"X-Requested-With":"xmlhttprequest"},body:o}).then(e=>e.json()).then(e=>{e.insertIsOk?(alert(e.msg),t.style.display="flex",n.style.display="none"):alert(e.msg)})})}function deconnect(){fetch(`${location.origin}/websignerr/controlers/deconnexion.php`).then(e=>e.json).then(e=>{alert("vous ete deconnecter"),location.assign("./")})}createComment(),deletePost(),fetchUpdatePost(),updateUserInfo();